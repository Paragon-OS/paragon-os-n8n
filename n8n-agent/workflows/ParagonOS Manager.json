{
  "updatedAt": "2025-11-22T14:16:37.000Z",
  "createdAt": "2025-11-06T23:04:10.688Z",
  "id": "z1Ry4y4k5dGR0BqR",
  "name": "ParagonOS Manager",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        -464,
        -584
      ],
      "id": "4077b1f3-df5a-4112-a949-a4a86c743d57",
      "name": "When chat message received",
      "webhookId": "171c216b-baf1-4dfc-b52e-280926480ed7",
      "disabled": true
    },
    {
      "parameters": {
        "options": {
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -240,
        -552
      ],
      "id": "4478f090-adaf-495e-8b71-37592aa93537",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "NIhZoi9otQV2vaAP",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "description": "={{ `\nIntelligently plans and executes Discord operations using cached context and AI-powered sequencing.\\n\\n# How It Works:\\n\\n1. **Context Enrichment**: Automatically retrieves and caches Discord contacts, guilds/servers, channels, available MCP tools, and your profile. Uses a 30-minute cache to minimize API calls.\\n\\n2. **AI Planning**: Analyzes your request against a Discord playbook of common workflows (DMing contacts, catching up on channels, replying to pending messages, searching topics, editing/deleting messages, downloading attachments, triaging guild channels). Recommends relevant tools and generates either:\\n   - A direct answer (if no API calls needed)\\n   - A sequential execution plan with specific MCP tool calls\\n\\n3. **Sequential Execution**: Executes planned steps in order, passing data between steps automatically.\\n\\n4. **Validation & Retry**: Validates execution results against your original request. Automatically retries with refined approach if needed.\\n\\n# Capabilities:\\n\\nRead messages (channels/DMs with pagination, date filtering), search messages, send/edit/delete messages with attachments, download attachments, list guilds/servers/channels/contacts/members, search contacts, get pending channels/DMs (messages after your last reply), manage whitelist/blacklist filters. Supports both server channels and direct messages.\n`}}",
        "workflowId": {
          "__rl": true,
          "value": "vfcxqLBDDMKL5lnG",
          "mode": "list",
          "cachedResultUrl": "/workflow/vfcxqLBDDMKL5lnG",
          "cachedResultName": "Discord MCP Client Sequencer"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "userPrompt": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('userPrompt', `Natural language request for Discord operations. Examples: 'Check for unreplied messages in wandrlust admin channel', 'DM sebastian about the meeting', 'What did people say about the launch in metarune-labs?', 'Reply to my pending DMs', 'List all members in the dev server'`, 'string') }}"
          },
          "matchingColumns": [
            "userPrompt"
          ],
          "schema": [
            {
              "id": "userPrompt",
              "displayName": "userPrompt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        16,
        -552
      ],
      "id": "a85ea5f0-1f3f-4d39-af49-35e27cade5b4",
      "name": "Discord Agent with Caching"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $workflow.id }} v7.10",
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -112,
        -552
      ],
      "id": "8b52e12c-7f0e-4129-8a64-80a18a1714b6",
      "name": "Conversation Memory"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.chatInput || $json.body.data.chatInput }}",
        "options": {
          "systemMessage": "=You are ParagonOS, an intelligent messaging platform management assistant supporting both Discord and Telegram.\n\n# Your Capabilities:\n\nYou have access to two sophisticated agent tools:\n\n**Discord Agent:**\n- Automatically enriches requests with cached context (contacts, guilds, channels, your profile)\n- Uses an AI planner with a playbook of common Discord workflows\n- Generates and executes sequential MCP tool operations\n- Validates results and retries with refined approaches if needed\n\n**Telegram Agent:**\n- Automatically enriches requests with cached context (contacts, chats, groups, your profile)\n- Uses an AI planner with a playbook of common Telegram workflows\n- Generates and executes sequential MCP tool operations\n- Validates results and retries with refined approaches if needed\n\n# How to Use the Agents:\n\n1. **Pass natural language requests directly** - The agents handle planning and execution automatically\n2. **Provide clear intent** - Be specific about what the user wants (check messages, send DM/message, search topics, etc.)\n3. **Include relevant context** - Mention channel/chat names, contact names, server/group names, time ranges, or specific topics\n4. **Specify the platform** - Clearly indicate whether the request is for Discord or Telegram (or both)\n5. **Trust the sub-workflows** - They will resolve names to IDs, plan multi-step operations, and handle retries\n\n# Good Examples:\n\n**Discord Examples:**\n- \"Check for unreplied messages in the wandrlust admin & dev channel\"\n- \"DM sebastian asking about the deployment status\"\n- \"What were the key points discussed about the token launch in metarune-labs?\"\n- \"Show me all pending DMs that need my attention\"\n- \"Find and list all messages from the past week in the dev-team channel\"\n\n**Telegram Examples:**\n- \"Check for unreplied messages from sebastian in Telegram\"\n- \"Message john about the meeting in Telegram\"\n- \"What did people say about the launch in the dev group on Telegram?\"\n- \"Show me all pending chats that need my attention in Telegram\"\n- \"Find and list all messages from the past week in the team group on Telegram\"\n\n**Cross-Platform Examples:**\n- \"Check for pending messages in both Discord and Telegram\"\n- \"Send a message to sebastian on both platforms about the meeting\"\n- \"What's new in my Discord DMs and Telegram chats?\"\n\n# Your Role:\n\n- Understand user intent and reformulate as clear, actionable requests\n- Determine which platform(s) the user wants to interact with (Discord, Telegram, or both)\n- Interpret the agent results and present them conversationally\n- Handle multi-turn conversations with context from memory\n- Ask clarifying questions if the user's request is ambiguous or doesn't specify a platform"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -120,
        -776
      ],
      "id": "e572d52c-0585-473c-84aa-34fc1b8ee691",
      "name": "Metarune Admin Chat Agent"
    },
    {
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "chatInput"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -464,
        -776
      ],
      "id": "c2a04407-3712-44aa-a758-a324f3b37a33",
      "name": "When Executed by Another Workflow",
      "disabled": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        352,
        -776
      ],
      "id": "b435c3de-9724-4add-bbbe-a0f0eeea066e",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {
        "description": "Intelligently plans and executes Telegram operations using cached context and AI-powered sequencing.\n\n# How It Works:\n\n1. **Context Enrichment**: Automatically retrieves and caches Telegram contacts, chats (users/groups/supergroups), available MCP tools, and your profile. Uses a 30-minute cache to minimize API calls.\n\n2. **AI Planning**: Analyzes your request against a Telegram playbook of common workflows (messaging contacts, catching up on chats, replying to pending messages, searching topics, editing/deleting messages, downloading attachments, triaging group chats). Recommends relevant tools and generates either:\n   - A direct answer (if no API calls needed)\n   - A sequential execution plan with specific MCP tool calls\n\n3. **Sequential Execution**: Executes planned steps in order, passing data between steps automatically.\n\n4. **Validation & Retry**: Validates execution results against your original request. Automatically retries with refined approach if needed.\n\n# Capabilities:\n\nRead messages (chats/groups with pagination, date filtering), search messages, send/edit/delete messages with attachments, download attachments, list chats/contacts/groups, search contacts, get pending chats (messages after your last reply), manage whitelist/blacklist filters. Supports both direct messages (user chats) and groups/supergroups.",
        "workflowId": {
          "__rl": true,
          "value": "rjoIG01kPyzaQwcU",
          "mode": "list",
          "cachedResultUrl": "/workflow/rjoIG01kPyzaQwcU",
          "cachedResultName": "Telegram MCP Client Sequencer"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "userPrompt": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('userPrompt', `Natural language request for Telegram operations. Examples: 'Check for unreplied messages from sebastian', 'Message john about the meeting', 'What did people say about the launch in the dev group?', 'Reply to my pending chats', 'List all contacts', 'Search for messages about deployment in the team group'`, 'string') }}"
          },
          "matchingColumns": [
            "userPrompt"
          ],
          "schema": [
            {
              "id": "userPrompt",
              "displayName": "userPrompt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        144,
        -552
      ],
      "id": "77779f7b-6217-46a5-a355-4cb35d2e935a",
      "name": "Telegram Agent with Caching"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "paragon-os",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -464,
        -1024
      ],
      "id": "5091dc73-abf5-4f5a-aacc-a390f39111b4",
      "name": "Webhook",
      "webhookId": "33384794-47ae-48e6-aa7d-64e81c9e4358"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "che6u5z0grJ4AoNr",
          "mode": "list",
          "cachedResultUrl": "/workflow/che6u5z0grJ4AoNr",
          "cachedResultName": "[HELPERS] Stream Update Sender"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "data": "={{ \n   {\"executionResult\": $json.output}\n}}",
            "stage": "manager_output",
            "status": "completed",
            "message": "Workflow completed successfully!"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "data",
              "displayName": "data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "object",
              "removed": false
            },
            {
              "id": "stage",
              "displayName": "stage",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "message",
              "displayName": "message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        576,
        -776
      ],
      "id": "58df62ec-7247-42bc-a866-7972255129a9",
      "name": "Send Stream Update"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "che6u5z0grJ4AoNr",
          "mode": "list",
          "cachedResultUrl": "/workflow/che6u5z0grJ4AoNr",
          "cachedResultName": "[HELPERS] Stream Update Sender"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "data": "={{ \n   {\"executionResult\": $json.output}\n}}",
            "stage": "manager_input",
            "status": "in_progress",
            "message": "=Workflow is starting with user prompt: {{ $json.body.data.chatInput?.toJsonString() }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "data",
              "displayName": "data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "object",
              "removed": false
            },
            {
              "id": "stage",
              "displayName": "stage",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "message",
              "displayName": "message",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        -56,
        -1072
      ],
      "id": "31b38a67-1985-49e5-9693-cb1e2932ff35",
      "name": "Send Stream Update2"
    }
  ],
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "Metarune Admin Chat Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Metarune Admin Chat Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Discord Agent with Caching": {
      "ai_tool": [
        [
          {
            "node": "Metarune Admin Chat Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Conversation Memory": {
      "ai_memory": [
        [
          {
            "node": "Metarune Admin Chat Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Metarune Admin Chat Agent": {
      "main": [
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "Metarune Admin Chat Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Agent with Caching": {
      "ai_tool": [
        [
          {
            "node": "Metarune Admin Chat Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Metarune Admin Chat Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send Stream Update2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Operation, do nothing": {
      "main": [
        [
          {
            "node": "Send Stream Update",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {
    "When Executed by Another Workflow": [
      {
        "json": {
          "chatInput": "find staryo admin only channel in metarune labs guild, then list messages"
        }
      }
    ]
  },
  "versionId": "4880314a-4274-483f-a34a-94120cac38f9",
  "versionCounter": 203,
  "triggerCount": 1,
  "tags": [
    {
      "updatedAt": "2025-11-02T21:22:20.646Z",
      "createdAt": "2025-11-02T21:22:20.646Z",
      "id": "95mwWdOxtdnkFLhS",
      "name": "Discord"
    },
    {
      "updatedAt": "2025-11-07T17:59:49.155Z",
      "createdAt": "2025-11-07T17:59:49.155Z",
      "id": "q6mxN2D7JQjPEzuF",
      "name": "Telegram"
    }
  ],
  "shared": [
    {
      "updatedAt": "2025-11-06T23:04:10.693Z",
      "createdAt": "2025-11-06T23:04:10.693Z",
      "role": "workflow:owner",
      "workflowId": "z1Ry4y4k5dGR0BqR",
      "projectId": "GEUEn6ArNROzJ5FY",
      "project": {
        "updatedAt": "2025-10-28T15:11:59.092Z",
        "createdAt": "2025-10-28T15:08:17.462Z",
        "id": "GEUEn6ArNROzJ5FY",
        "name": "Paragon TheDev <paragoncryptodev@gmail.com>",
        "type": "personal",
        "icon": null,
        "description": null
      }
    }
  ]
}